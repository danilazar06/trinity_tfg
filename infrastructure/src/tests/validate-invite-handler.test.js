"use strict";
/**
 * Unit Tests for Validate Invite Handler
 * Feature: trinity-voting-fixes
 *
 * Tests the web landing page invite validation API endpoint
 */
Object.defineProperty(exports, "__esModule", { value: true });
// Mock dependencies
jest.mock('../services/deepLinkService');
jest.mock('../utils/metrics');
const validateInvite_1 = require("../handlers/validateInvite");
const deepLinkService_1 = require("../services/deepLinkService");
describe('Validate Invite Handler', () => {
    const mockValidateInviteCode = deepLinkService_1.deepLinkService.validateInviteCode;
    beforeEach(() => {
        jest.clearAllMocks();
    });
    const createMockEvent = (body, method = 'POST') => ({
        httpMethod: method,
        body,
        headers: {},
        multiValueHeaders: {},
        isBase64Encoded: false,
        path: '/validate-invite',
        pathParameters: null,
        queryStringParameters: null,
        multiValueQueryStringParameters: null,
        stageVariables: null,
        requestContext: {},
        resource: '',
    });
    describe('CORS Handling', () => {
        it('should handle OPTIONS preflight requests', async () => {
            const event = createMockEvent('', 'OPTIONS');
            const result = await (0, validateInvite_1.handler)(event);
            expect(result.statusCode).toBe(200);
            expect(result.headers).toMatchObject({
                'Access-Control-Allow-Origin': '*',
                'Access-Control-Allow-Headers': 'Content-Type',
                'Access-Control-Allow-Methods': 'POST, OPTIONS',
            });
            expect(result.body).toBe('');
        });
        it('should include CORS headers in all responses', async () => {
            const event = createMockEvent(JSON.stringify({ inviteCode: 'ABC123' }));
            mockValidateInviteCode.mockResolvedValue(null);
            const result = await (0, validateInvite_1.handler)(event);
            expect(result.headers).toMatchObject({
                'Access-Control-Allow-Origin': '*',
                'Access-Control-Allow-Headers': 'Content-Type',
                'Access-Control-Allow-Methods': 'POST, OPTIONS',
                'Content-Type': 'application/json',
            });
        });
    });
    describe('Request Validation', () => {
        it('should return 400 for missing request body', async () => {
            const event = createMockEvent('');
            event.body = null;
            const result = await (0, validateInvite_1.handler)(event);
            expect(result.statusCode).toBe(400);
            const body = JSON.parse(result.body);
            expect(body.valid).toBe(false);
            expect(body.error).toBe('Request body is required');
        });
        it('should return 400 for missing invite code', async () => {
            const event = createMockEvent(JSON.stringify({}));
            const result = await (0, validateInvite_1.handler)(event);
            expect(result.statusCode).toBe(400);
            const body = JSON.parse(result.body);
            expect(body.valid).toBe(false);
            expect(body.error).toBe('Invite code is required');
        });
        it('should return 400 for invalid invite code format', async () => {
            const invalidCodes = ['ABC12', 'TOOLONG123', 'ABC-123'];
            for (const code of invalidCodes) {
                const event = createMockEvent(JSON.stringify({ inviteCode: code }));
                const result = await (0, validateInvite_1.handler)(event);
                expect(result.statusCode).toBe(400);
                const body = JSON.parse(result.body);
                expect(body.valid).toBe(false);
                expect(body.error).toBe('Invalid invite code format');
            }
            // Test empty string separately as it should be "required" error
            const emptyEvent = createMockEvent(JSON.stringify({ inviteCode: '' }));
            const emptyResult = await (0, validateInvite_1.handler)(emptyEvent);
            expect(emptyResult.statusCode).toBe(400);
            const emptyBody = JSON.parse(emptyResult.body);
            expect(emptyBody.valid).toBe(false);
            expect(emptyBody.error).toBe('Invite code is required');
        });
    });
    describe('Invite Code Validation', () => {
        it('should return valid response for existing invite code', async () => {
            const mockRoomInfo = {
                roomId: 'room-123',
                name: 'Test Room',
                hostId: 'user-456',
                status: 'ACTIVE',
                memberCount: 3,
                isPrivate: false,
                createdAt: '2026-01-10T12:00:00Z',
            };
            mockValidateInviteCode.mockResolvedValue(mockRoomInfo);
            const event = createMockEvent(JSON.stringify({ inviteCode: 'ABC123' }));
            const result = await (0, validateInvite_1.handler)(event);
            expect(result.statusCode).toBe(200);
            const body = JSON.parse(result.body);
            expect(body.valid).toBe(true);
            expect(body.room).toEqual(mockRoomInfo);
            expect(body.inviteCode).toBe('ABC123');
            expect(mockValidateInviteCode).toHaveBeenCalledWith('ABC123');
        });
        it('should return invalid response for non-existent invite code', async () => {
            mockValidateInviteCode.mockResolvedValue(null);
            const event = createMockEvent(JSON.stringify({ inviteCode: 'NOTFND' }));
            const result = await (0, validateInvite_1.handler)(event);
            expect(result.statusCode).toBe(200);
            const body = JSON.parse(result.body);
            expect(body.valid).toBe(false);
            expect(body.error).toBe('Invalid or expired invite code');
            expect(body.inviteCode).toBe('NOTFND');
        });
        it('should normalize invite code to uppercase', async () => {
            const mockRoomInfo = {
                roomId: 'room-123',
                name: 'Test Room',
                hostId: 'user-456',
                status: 'ACTIVE',
                memberCount: 1,
                isPrivate: false,
                createdAt: '2026-01-10T12:00:00Z',
            };
            mockValidateInviteCode.mockResolvedValue(mockRoomInfo);
            const event = createMockEvent(JSON.stringify({ inviteCode: 'abc123' }));
            const result = await (0, validateInvite_1.handler)(event);
            expect(result.statusCode).toBe(200);
            expect(mockValidateInviteCode).toHaveBeenCalledWith('ABC123');
            const body = JSON.parse(result.body);
            expect(body.inviteCode).toBe('ABC123');
        });
    });
    describe('Error Handling', () => {
        it('should handle service errors gracefully', async () => {
            mockValidateInviteCode.mockRejectedValue(new Error('Database connection failed'));
            const event = createMockEvent(JSON.stringify({ inviteCode: 'ABC123' }));
            const result = await (0, validateInvite_1.handler)(event);
            expect(result.statusCode).toBe(500);
            const body = JSON.parse(result.body);
            expect(body.valid).toBe(false);
            expect(body.error).toBe('Internal server error');
        });
        it('should handle malformed JSON in request body', async () => {
            const event = createMockEvent('invalid json');
            const result = await (0, validateInvite_1.handler)(event);
            expect(result.statusCode).toBe(500);
            const body = JSON.parse(result.body);
            expect(body.valid).toBe(false);
            expect(body.error).toBe('Internal server error');
        });
    });
    describe('Response Format', () => {
        it('should return consistent response structure for valid invites', async () => {
            const mockRoomInfo = {
                roomId: 'room-123',
                name: 'Movie Night',
                hostId: 'user-456',
                status: 'ACTIVE',
                memberCount: 5,
                isPrivate: true,
                createdAt: '2026-01-10T12:00:00Z',
            };
            mockValidateInviteCode.mockResolvedValue(mockRoomInfo);
            const event = createMockEvent(JSON.stringify({ inviteCode: 'XYZ789' }));
            const result = await (0, validateInvite_1.handler)(event);
            expect(result.statusCode).toBe(200);
            const body = JSON.parse(result.body);
            // Check response structure
            expect(body).toHaveProperty('valid', true);
            expect(body).toHaveProperty('room');
            expect(body).toHaveProperty('inviteCode', 'XYZ789');
            // Check room structure
            expect(body.room).toHaveProperty('roomId');
            expect(body.room).toHaveProperty('name');
            expect(body.room).toHaveProperty('hostId');
            expect(body.room).toHaveProperty('status');
            expect(body.room).toHaveProperty('memberCount');
            expect(body.room).toHaveProperty('isPrivate');
            expect(body.room).toHaveProperty('createdAt');
        });
        it('should return consistent response structure for invalid invites', async () => {
            mockValidateInviteCode.mockResolvedValue(null);
            const event = createMockEvent(JSON.stringify({ inviteCode: 'EXPIRE' }));
            const result = await (0, validateInvite_1.handler)(event);
            expect(result.statusCode).toBe(200);
            const body = JSON.parse(result.body);
            // Check response structure
            expect(body).toHaveProperty('valid', false);
            expect(body).toHaveProperty('error');
            expect(body).toHaveProperty('inviteCode', 'EXPIRE');
            expect(body).not.toHaveProperty('room');
        });
    });
    describe('Edge Cases', () => {
        it('should handle room with minimal information', async () => {
            const mockRoomInfo = {
                roomId: 'room-minimal',
                name: '',
                hostId: '',
                status: 'UNKNOWN',
                memberCount: 0,
                isPrivate: false,
                createdAt: '',
            };
            mockValidateInviteCode.mockResolvedValue(mockRoomInfo);
            const event = createMockEvent(JSON.stringify({ inviteCode: 'MIN123' }));
            const result = await (0, validateInvite_1.handler)(event);
            expect(result.statusCode).toBe(200);
            const body = JSON.parse(result.body);
            expect(body.valid).toBe(true);
            expect(body.room).toEqual(mockRoomInfo);
        });
        it('should handle very long room names', async () => {
            const longName = 'A'.repeat(1000);
            const mockRoomInfo = {
                roomId: 'room-long',
                name: longName,
                hostId: 'user-123',
                status: 'ACTIVE',
                memberCount: 1,
                isPrivate: false,
                createdAt: '2026-01-10T12:00:00Z',
            };
            mockValidateInviteCode.mockResolvedValue(mockRoomInfo);
            const event = createMockEvent(JSON.stringify({ inviteCode: 'LONG12' }));
            const result = await (0, validateInvite_1.handler)(event);
            expect(result.statusCode).toBe(200);
            const body = JSON.parse(result.body);
            expect(body.valid).toBe(true);
            expect(body.room.name).toBe(longName);
        });
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmFsaWRhdGUtaW52aXRlLWhhbmRsZXIudGVzdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbInZhbGlkYXRlLWludml0ZS1oYW5kbGVyLnRlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBOzs7OztHQUtHOztBQUVILG9CQUFvQjtBQUNwQixJQUFJLENBQUMsSUFBSSxDQUFDLDZCQUE2QixDQUFDLENBQUM7QUFDekMsSUFBSSxDQUFDLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDO0FBRTlCLCtEQUFxRDtBQUNyRCxpRUFBOEQ7QUFHOUQsUUFBUSxDQUFDLHlCQUF5QixFQUFFLEdBQUcsRUFBRTtJQUN2QyxNQUFNLHNCQUFzQixHQUFHLGlDQUFlLENBQUMsa0JBQW9GLENBQUM7SUFFcEksVUFBVSxDQUFDLEdBQUcsRUFBRTtRQUNkLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztJQUN2QixDQUFDLENBQUMsQ0FBQztJQUVILE1BQU0sZUFBZSxHQUFHLENBQUMsSUFBWSxFQUFFLFNBQWlCLE1BQU0sRUFBd0IsRUFBRSxDQUFDLENBQUM7UUFDeEYsVUFBVSxFQUFFLE1BQU07UUFDbEIsSUFBSTtRQUNKLE9BQU8sRUFBRSxFQUFFO1FBQ1gsaUJBQWlCLEVBQUUsRUFBRTtRQUNyQixlQUFlLEVBQUUsS0FBSztRQUN0QixJQUFJLEVBQUUsa0JBQWtCO1FBQ3hCLGNBQWMsRUFBRSxJQUFJO1FBQ3BCLHFCQUFxQixFQUFFLElBQUk7UUFDM0IsK0JBQStCLEVBQUUsSUFBSTtRQUNyQyxjQUFjLEVBQUUsSUFBSTtRQUNwQixjQUFjLEVBQUUsRUFBUztRQUN6QixRQUFRLEVBQUUsRUFBRTtLQUNiLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxlQUFlLEVBQUUsR0FBRyxFQUFFO1FBQzdCLEVBQUUsQ0FBQywwQ0FBMEMsRUFBRSxLQUFLLElBQUksRUFBRTtZQUN4RCxNQUFNLEtBQUssR0FBRyxlQUFlLENBQUMsRUFBRSxFQUFFLFNBQVMsQ0FBQyxD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QWlCLENBQUMsWUFBWSxDQUFDLENBQUM7WUFFdkQsTUFBTSxLQUFLLEdBQUcsZUFBZSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsRUFBRSxVQUFVLEVBQUUsUUFBUSxFQUFFLENBQUMsQ0FBQyxDQUFDO1lBQ3hFLE1BQU0sTUFBTSxHQUFHLE1BQU0sSUFBQSx3QkFBTyxFQUFDLEtBQUssQ0FBQyxDQUFDO1lBRXBDLE1BQU0sQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQ3BDLE1BQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ3JDLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQzlCLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUN4QyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogVW5pdCBUZXN0cyBmb3IgVmFsaWRhdGUgSW52aXRlIEhhbmRsZXJcclxuICogRmVhdHVyZTogdHJpbml0eS12b3RpbmctZml4ZXNcclxuICogXHJcbiAqIFRlc3RzIHRoZSB3ZWIgbGFuZGluZyBwYWdlIGludml0ZSB2YWxpZGF0aW9uIEFQSSBlbmRwb2ludFxyXG4gKi9cclxuXHJcbi8vIE1vY2sgZGVwZW5kZW5jaWVzXHJcbmplc3QubW9jaygnLi4vc2VydmljZXMvZGVlcExpbmtTZXJ2aWNlJyk7XHJcbmplc3QubW9jaygnLi4vdXRpbHMvbWV0cmljcycpO1xyXG5cclxuaW1wb3J0IHsgaGFuZGxlciB9IGZyb20gJy4uL2hhbmRsZXJzL3ZhbGlkYXRlSW52aXRlJztcclxuaW1wb3J0IHsgZGVlcExpbmtTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvZGVlcExpbmtTZXJ2aWNlJztcclxuaW1wb3J0IHsgQVBJR2F0ZXdheVByb3h5RXZlbnQgfSBmcm9tICdhd3MtbGFtYmRhJztcclxuXHJcbmRlc2NyaWJlKCdWYWxpZGF0ZSBJbnZpdGUgSGFuZGxlcicsICgpID0+IHtcclxuICBjb25zdCBtb2NrVmFsaWRhdGVJbnZpdGVDb2RlID0gZGVlcExpbmtTZXJ2aWNlLnZhbGlkYXRlSW52aXRlQ29kZSBhcyBqZXN0Lk1vY2tlZEZ1bmN0aW9uPHR5cGVvZiBkZWVwTGlua1NlcnZpY2UudmFsaWRhdGVJbnZpdGVDb2RlPjtcclxuXHJcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcclxuICB9KTtcclxuXHJcbiAgY29uc3QgY3JlYXRlTW9ja0V2ZW50ID0gKGJvZHk6IHN0cmluZywgbWV0aG9kOiBzdHJpbmcgPSAnUE9TVCcpOiBBUElHYXRld2F5UHJveHlFdmVudCA9PiAoe1xyXG4gICAgaHR0cE1ldGhvZDogbWV0aG9kLFxyXG4gICAgYm9keSxcclxuICAgIGhlYWRlcnM6IHt9LFxyXG4gICAgbXVsdGlWYWx1ZUhlYWRlcnM6IHt9LFxyXG4gICAgaXNCYXNlNjRFbmNvZGVkOiBmYWxzZSxcclxuICAgIHBhdGg6ICcvdmFsaWRhdGUtaW52aXRlJyxcclxuICAgIHBhdGhQYXJhbWV0ZXJzOiBudWxsLFxyXG4gICAgcXVlcnlTdHJpbmdQYXJhbWV0ZXJzOiBudWxsLFxyXG4gICAgbXVsdGlWYWx1ZVF1ZXJ5U3RyaW5nUGFyYW1ldGVyczogbnVsbCxcclxuICAgIHN0YWdlVmFyaWFibGVzOiBudWxsLFxyXG4gICAgcmVxdWVzdENvbnRleHQ6IHt9IGFzIGFueSxcclxuICAgIHJlc291cmNlOiAnJyxcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ0NPUlMgSGFuZGxpbmcnLCAoKSA9PiB7XHJcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBPUFRJT05TIHByZWZsaWdodCByZXF1ZXN0cycsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgZXZlbnQgPSBjcmVhdGVNb2NrRXZlbnQoJycsICdPUFRJT05TJyk7XHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGhhbmRsZXIoZXZlbnQpO1xyXG5cclxuICAgICAgZXhwZWN0KHJlc3VsdC5zdGF0dXNDb2RlKS50b0JlKDIwMCk7XHJcbiAgICAgIGV4cGVjdChyZXN1bHQuaGVhZGVycykudG9NYXRjaE9iamVjdCh7XHJcbiAgICAgICAgJ0FjY2Vzcy1Db250cm9sLUFsbG93LU9yaWdpbic6ICcqJyxcclxuICAgICAgICAnQWNjZXNzLUNvbnRyb2wtQWxsb3ctSGVhZGVycyc6ICdDb250ZW50LVR5cGUnLFxyXG4gICAgICAgICdBY2Nlc3MtQ29udHJvbC1BbGxvdy1NZXRob2RzJzogJ1BPU1QsIE9QVElPTlMnLFxyXG4gICAgICB9KTtcclxuICAgICAgZXhwZWN0KHJlc3VsdC5ib2R5KS50b0JlKCcnKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgaW5jbHVkZSBDT1JTIGhlYWRlcnMgaW4gYWxsIHJlc3BvbnNlcycsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgZXZlbnQgPSBjcmVhdGVNb2NrRXZlbnQoSlNPTi5zdHJpbmdpZnkoeyBpbnZpdGVDb2RlOiAnQUJDMTIzJyB9KSk7XHJcbiAgICAgIG1vY2tWYWxpZGF0ZUludml0ZUNvZGUubW9ja1Jlc29sdmVkVmFsdWUobnVsbCk7XHJcblxyXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBoYW5kbGVyKGV2ZW50KTtcclxuXHJcbiAgICAgIGV4cGVjdChyZXN1bHQuaGVhZGVycykudG9NYXRjaE9iamVjdCh7XHJcbiAgICAgICAgJ0FjY2Vzcy1Db250cm9sLUFsbG93LU9yaWdpbic6ICcqJyxcclxuICAgICAgICAnQWNjZXNzLUNvbnRyb2wtQWxsb3ctSGVhZGVycyc6ICdDb250ZW50LVR5cGUnLFxyXG4gICAgICAgICdBY2Nlc3MtQ29udHJvbC1BbGxvdy1NZXRob2RzJzogJ1BPU1QsIE9QVElPTlMnLFxyXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdSZXF1ZXN0IFZhbGlkYXRpb24nLCAoKSA9PiB7XHJcbiAgICBpdCgnc2hvdWxkIHJldHVybiA0MDAgZm9yIG1pc3NpbmcgcmVxdWVzdCBib2R5JywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBldmVudCA9IGNyZWF0ZU1vY2tFdmVudCgnJyk7XHJcbiAgICAgIGV2ZW50LmJvZHkgPSBudWxsO1xyXG5cclxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgaGFuZGxlcihldmVudCk7XHJcblxyXG4gICAgICBleHBlY3QocmVzdWx0LnN0YXR1c0NvZGUpLnRvQmUoNDAwKTtcclxuICAgICAgY29uc3QgYm9keSA9IEpTT04ucGFyc2UocmVzdWx0LmJvZHkpO1xyXG4gICAgICBleHBlY3QoYm9keS52YWxpZCkudG9CZShmYWxzZSk7XHJcbiAgICAgIGV4cGVjdChib2R5LmVycm9yKS50b0JlKCdSZXF1ZXN0IGJvZHkgaXMgcmVxdWlyZWQnKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgcmV0dXJuIDQwMCBmb3IgbWlzc2luZyBpbnZpdGUgY29kZScsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgZXZlbnQgPSBjcmVhdGVNb2NrRXZlbnQoSlNPTi5zdHJpbmdpZnkoe30pKTtcclxuXHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGhhbmRsZXIoZXZlbnQpO1xyXG5cclxuICAgICAgZXhwZWN0KHJlc3VsdC5zdGF0dXNDb2RlKS50b0JlKDQwMCk7XHJcbiAgICAgIGNvbnN0IGJvZHkgPSBKU09OLnBhcnNlKHJlc3VsdC5ib2R5KTtcclxuICAgICAgZXhwZWN0KGJvZHkudmFsaWQpLnRvQmUoZmFsc2UpO1xyXG4gICAgICBleHBlY3QoYm9keS5lcnJvcikudG9CZSgnSW52aXRlIGNvZGUgaXMgcmVxdWlyZWQnKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgcmV0dXJuIDQwMCBmb3IgaW52YWxpZCBpbnZpdGUgY29kZSBmb3JtYXQnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGludmFsaWRDb2RlcyA9IFsnQUJDMTInLCAnVE9PTE9ORzEyMycsICdBQkMtMTIzJ107XHJcblxyXG4gICAgICBmb3IgKGNvbnN0IGNvZGUgb2YgaW52YWxpZENvZGVzKSB7XHJcbiAgICAgICAgY29uc3QgZXZlbnQgPSBjcmVhdGVNb2NrRXZlbnQoSlNPTi5zdHJpbmdpZnkoeyBpbnZpdGVDb2RlOiBjb2RlIH0pKTtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBoYW5kbGVyKGV2ZW50KTtcclxuXHJcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5zdGF0dXNDb2RlKS50b0JlKDQwMCk7XHJcbiAgICAgICAgY29uc3QgYm9keSA9IEpTT04ucGFyc2UocmVzdWx0LmJvZHkpO1xyXG4gICAgICAgIGV4cGVjdChib2R5LnZhbGlkKS50b0JlKGZhbHNlKTtcclxuICAgICAgICBleHBlY3QoYm9keS5lcnJvcikudG9CZSgnSW52YWxpZCBpbnZpdGUgY29kZSBmb3JtYXQnKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gVGVzdCBlbXB0eSBzdHJpbmcgc2VwYXJhdGVseSBhcyBpdCBzaG91bGQgYmUgXCJyZXF1aXJlZFwiIGVycm9yXHJcbiAgICAgIGNvbnN0IGVtcHR5RXZlbnQgPSBjcmVhdGVNb2NrRXZlbnQoSlNPTi5zdHJpbmdpZnkoeyBpbnZpdGVDb2RlOiAnJyB9KSk7XHJcbiAgICAgIGNvbnN0IGVtcHR5UmVzdWx0ID0gYXdhaXQgaGFuZGxlcihlbXB0eUV2ZW50KTtcclxuICAgICAgXHJcbiAgICAgIGV4cGVjdChlbXB0eVJlc3VsdC5zdGF0dXNDb2RlKS50b0JlKDQwMCk7XHJcbiAgICAgIGNvbnN0IGVtcHR5Qm9keSA9IEpTT04ucGFyc2UoZW1wdHlSZXN1bHQuYm9keSk7XHJcbiAgICAgIGV4cGVjdChlbXB0eUJvZHkudmFsaWQpLnRvQmUoZmFsc2UpO1xyXG4gICAgICBleHBlY3QoZW1wdHlCb2R5LmVycm9yKS50b0JlKCdJbnZpdGUgY29kZSBpcyByZXF1aXJlZCcpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdJbnZpdGUgQ29kZSBWYWxpZGF0aW9uJywgKCkgPT4ge1xyXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gdmFsaWQgcmVzcG9uc2UgZm9yIGV4aXN0aW5nIGludml0ZSBjb2RlJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBtb2NrUm9vbUluZm8gPSB7XHJcbiAgICAgICAgcm9vbUlkOiAncm9vbS0xMjMnLFxyXG4gICAgICAgIG5hbWU6ICdUZXN0IFJvb20nLFxyXG4gICAgICAgIGhvc3RJZDogJ3VzZXItNDU2JyxcclxuICAgICAgICBzdGF0dXM6ICdBQ1RJVkUnLFxyXG4gICAgICAgIG1lbWJlckNvdW50OiAzLFxyXG4gICAgICAgIGlzUHJpdmF0ZTogZmFsc2UsXHJcbiAgICAgICAgY3JlYXRlZEF0OiAnMjAyNi0wMS0xMFQxMjowMDowMFonLFxyXG4gICAgICB9O1xyXG5cclxuICAgICAgbW9ja1ZhbGlkYXRlSW52aXRlQ29kZS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrUm9vbUluZm8pO1xyXG5cclxuICAgICAgY29uc3QgZXZlbnQgPSBjcmVhdGVNb2NrRXZlbnQoSlNPTi5zdHJpbmdpZnkoeyBpbnZpdGVDb2RlOiAnQUJDMTIzJyB9KSk7XHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGhhbmRsZXIoZXZlbnQpO1xyXG5cclxuICAgICAgZXhwZWN0KHJlc3VsdC5zdGF0dXNDb2RlKS50b0JlKDIwMCk7XHJcbiAgICAgIGNvbnN0IGJvZHkgPSBKU09OLnBhcnNlKHJlc3VsdC5ib2R5KTtcclxuICAgICAgZXhwZWN0KGJvZHkudmFsaWQpLnRvQmUodHJ1ZSk7XHJcbiAgICAgIGV4cGVjdChib2R5LnJvb20pLnRvRXF1YWwobW9ja1Jvb21JbmZvKTtcclxuICAgICAgZXhwZWN0KGJvZHkuaW52aXRlQ29kZSkudG9CZSgnQUJDMTIzJyk7XHJcbiAgICAgIGV4cGVjdChtb2NrVmFsaWRhdGVJbnZpdGVDb2RlKS50b0hhdmVCZWVuQ2FsbGVkV2l0aCgnQUJDMTIzJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIHJldHVybiBpbnZhbGlkIHJlc3BvbnNlIGZvciBub24tZXhpc3RlbnQgaW52aXRlIGNvZGUnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIG1vY2tWYWxpZGF0ZUludml0ZUNvZGUubW9ja1Jlc29sdmVkVmFsdWUobnVsbCk7XHJcblxyXG4gICAgICBjb25zdCBldmVudCA9IGNyZWF0ZU1vY2tFdmVudChKU09OLnN0cmluZ2lmeSh7IGludml0ZUNvZGU6ICdOT1RGTkQnIH0pKTtcclxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgaGFuZGxlcihldmVudCk7XHJcblxyXG4gICAgICBleHBlY3QocmVzdWx0LnN0YXR1c0NvZGUpLnRvQmUoMjAwKTtcclxuICAgICAgY29uc3QgYm9keSA9IEpTT04ucGFyc2UocmVzdWx0LmJvZHkpO1xyXG4gICAgICBleHBlY3QoYm9keS52YWxpZCkudG9CZShmYWxzZSk7XHJcbiAgICAgIGV4cGVjdChib2R5LmVycm9yKS50b0JlKCdJbnZhbGlkIG9yIGV4cGlyZWQgaW52aXRlIGNvZGUnKTtcclxuICAgICAgZXhwZWN0KGJvZHkuaW52aXRlQ29kZSkudG9CZSgnTk9URk5EJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIG5vcm1hbGl6ZSBpbnZpdGUgY29kZSB0byB1cHBlcmNhc2UnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IG1vY2tSb29tSW5mbyA9IHtcclxuICAgICAgICByb29tSWQ6ICdyb29tLTEyMycsXHJcbiAgICAgICAgbmFtZTogJ1Rlc3QgUm9vbScsXHJcbiAgICAgICAgaG9zdElkOiAndXNlci00NTYnLFxyXG4gICAgICAgIHN0YXR1czogJ0FDVElWRScsXHJcbiAgICAgICAgbWVtYmVyQ291bnQ6IDEsXHJcbiAgICAgICAgaXNQcml2YXRlOiBmYWxzZSxcclxuICAgICAgICBjcmVhdGVkQXQ6ICcyMDI2LTAxLTEwVDEyOjAwOjAwWicsXHJcbiAgICAgIH07XHJcblxyXG4gICAgICBtb2NrVmFsaWRhdGVJbnZpdGVDb2RlLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tSb29tSW5mbyk7XHJcblxyXG4gICAgICBjb25zdCBldmVudCA9IGNyZWF0ZU1vY2tFdmVudChKU09OLnN0cmluZ2lmeSh7IGludml0ZUNvZGU6ICdhYmMxMjMnIH0pKTtcclxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgaGFuZGxlcihldmVudCk7XHJcblxyXG4gICAgICBleHBlY3QocmVzdWx0LnN0YXR1c0NvZGUpLnRvQmUoMjAwKTtcclxuICAgICAgZXhwZWN0KG1vY2tWYWxpZGF0ZUludml0ZUNvZGUpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdBQkMxMjMnKTtcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IGJvZHkgPSBKU09OLnBhcnNlKHJlc3VsdC5ib2R5KTtcclxuICAgICAgZXhwZWN0KGJvZHkuaW52aXRlQ29kZSkudG9CZSgnQUJDMTIzJyk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ0Vycm9yIEhhbmRsaW5nJywgKCkgPT4ge1xyXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgc2VydmljZSBlcnJvcnMgZ3JhY2VmdWxseScsIGFzeW5jICgpID0+IHtcclxuICAgICAgbW9ja1ZhbGlkYXRlSW52aXRlQ29kZS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ0RhdGFiYXNlIGNvbm5lY3Rpb24gZmFpbGVkJykpO1xyXG5cclxuICAgICAgY29uc3QgZXZlbnQgPSBjcmVhdGVNb2NrRXZlbnQoSlNPTi5zdHJpbmdpZnkoeyBpbnZpdGVDb2RlOiAnQUJDMTIzJyB9KSk7XHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGhhbmRsZXIoZXZlbnQpO1xyXG5cclxuICAgICAgZXhwZWN0KHJlc3VsdC5zdGF0dXNDb2RlKS50b0JlKDUwMCk7XHJcbiAgICAgIGNvbnN0IGJvZHkgPSBKU09OLnBhcnNlKHJlc3VsdC5ib2R5KTtcclxuICAgICAgZXhwZWN0KGJvZHkudmFsaWQpLnRvQmUoZmFsc2UpO1xyXG4gICAgICBleHBlY3QoYm9keS5lcnJvcikudG9CZSgnSW50ZXJuYWwgc2VydmVyIGVycm9yJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBtYWxmb3JtZWQgSlNPTiBpbiByZXF1ZXN0IGJvZHknLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGV2ZW50ID0gY3JlYXRlTW9ja0V2ZW50KCdpbnZhbGlkIGpzb24nKTtcclxuXHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGhhbmRsZXIoZXZlbnQpO1xyXG5cclxuICAgICAgZXhwZWN0KHJlc3VsdC5zdGF0dXNDb2RlKS50b0JlKDUwMCk7XHJcbiAgICAgIGNvbnN0IGJvZHkgPSBKU09OLnBhcnNlKHJlc3VsdC5ib2R5KTtcclxuICAgICAgZXhwZWN0KGJvZHkudmFsaWQpLnRvQmUoZmFsc2UpO1xyXG4gICAgICBleHBlY3QoYm9keS5lcnJvcikudG9CZSgnSW50ZXJuYWwgc2VydmVyIGVycm9yJyk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ1Jlc3BvbnNlIEZvcm1hdCcsICgpID0+IHtcclxuICAgIGl0KCdzaG91bGQgcmV0dXJuIGNvbnNpc3RlbnQgcmVzcG9uc2Ugc3RydWN0dXJlIGZvciB2YWxpZCBpbnZpdGVzJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBtb2NrUm9vbUluZm8gPSB7XHJcbiAgICAgICAgcm9vbUlkOiAncm9vbS0xMjMnLFxyXG4gICAgICAgIG5hbWU6ICdNb3ZpZSBOaWdodCcsXHJcbiAgICAgICAgaG9zdElkOiAndXNlci00NTYnLFxyXG4gICAgICAgIHN0YXR1czogJ0FDVElWRScsXHJcbiAgICAgICAgbWVtYmVyQ291bnQ6IDUsXHJcbiAgICAgICAgaXNQcml2YXRlOiB0cnVlLFxyXG4gICAgICAgIGNyZWF0ZWRBdDogJzIwMjYtMDEtMTBUMTI6MDA6MDBaJyxcclxuICAgICAgfTtcclxuXHJcbiAgICAgIG1vY2tWYWxpZGF0ZUludml0ZUNvZGUubW9ja1Jlc29sdmVkVmFsdWUobW9ja1Jvb21JbmZvKTtcclxuXHJcbiAgICAgIGNvbnN0IGV2ZW50ID0gY3JlYXRlTW9ja0V2ZW50KEpTT04uc3RyaW5naWZ5KHsgaW52aXRlQ29kZTogJ1hZWjc4OScgfSkpO1xyXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBoYW5kbGVyKGV2ZW50KTtcclxuXHJcbiAgICAgIGV4cGVjdChyZXN1bHQuc3RhdHVzQ29kZSkudG9CZSgyMDApO1xyXG4gICAgICBjb25zdCBib2R5ID0gSlNPTi5wYXJzZShyZXN1bHQuYm9keSk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBDaGVjayByZXNwb25zZSBzdHJ1Y3R1cmVcclxuICAgICAgZXhwZWN0KGJvZHkpLnRvSGF2ZVByb3BlcnR5KCd2YWxpZCcsIHRydWUpO1xyXG4gICAgICBleHBlY3QoYm9keSkudG9IYXZlUHJvcGVydHkoJ3Jvb20nKTtcclxuICAgICAgZXhwZWN0KGJvZHkpLnRvSGF2ZVByb3BlcnR5KCdpbnZpdGVDb2RlJywgJ1hZWjc4OScpO1xyXG4gICAgICBcclxuICAgICAgLy8gQ2hlY2sgcm9vbSBzdHJ1Y3R1cmVcclxuICAgICAgZXhwZWN0KGJvZHkucm9vbSkudG9IYXZlUHJvcGVydHkoJ3Jvb21JZCcpO1xyXG4gICAgICBleHBlY3QoYm9keS5yb29tKS50b0hhdmVQcm9wZXJ0eSgnbmFtZScpO1xyXG4gICAgICBleHBlY3QoYm9keS5yb29tKS50b0hhdmVQcm9wZXJ0eSgnaG9zdElkJyk7XHJcbiAgICAgIGV4cGVjdChib2R5LnJvb20pLnRvSGF2ZVByb3BlcnR5KCdzdGF0dXMnKTtcclxuICAgICAgZXhwZWN0KGJvZHkucm9vbSkudG9IYXZlUHJvcGVydHkoJ21lbWJlckNvdW50Jyk7XHJcbiAgICAgIGV4cGVjdChib2R5LnJvb20pLnRvSGF2ZVByb3BlcnR5KCdpc1ByaXZhdGUnKTtcclxuICAgICAgZXhwZWN0KGJvZHkucm9vbSkudG9IYXZlUHJvcGVydHkoJ2NyZWF0ZWRBdCcpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gY29uc2lzdGVudCByZXNwb25zZSBzdHJ1Y3R1cmUgZm9yIGludmFsaWQgaW52aXRlcycsIGFzeW5jICgpID0+IHtcclxuICAgICAgbW9ja1ZhbGlkYXRlSW52aXRlQ29kZS5tb2NrUmVzb2x2ZWRWYWx1ZShudWxsKTtcclxuXHJcbiAgICAgIGNvbnN0IGV2ZW50ID0gY3JlYXRlTW9ja0V2ZW50KEpTT04uc3RyaW5naWZ5KHsgaW52aXRlQ29kZTogJ0VYUElSRScgfSkpO1xyXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBoYW5kbGVyKGV2ZW50KTtcclxuXHJcbiAgICAgIGV4cGVjdChyZXN1bHQuc3RhdHVzQ29kZSkudG9CZSgyMDApO1xyXG4gICAgICBjb25zdCBib2R5ID0gSlNPTi5wYXJzZShyZXN1bHQuYm9keSk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBDaGVjayByZXNwb25zZSBzdHJ1Y3R1cmVcclxuICAgICAgZXhwZWN0KGJvZHkpLnRvSGF2ZVByb3BlcnR5KCd2YWxpZCcsIGZhbHNlKTtcclxuICAgICAgZXhwZWN0KGJvZHkpLnRvSGF2ZVByb3BlcnR5KCdlcnJvcicpO1xyXG4gICAgICBleHBlY3QoYm9keSkudG9IYXZlUHJvcGVydHkoJ2ludml0ZUNvZGUnLCAnRVhQSVJFJyk7XHJcbiAgICAgIGV4cGVjdChib2R5KS5ub3QudG9IYXZlUHJvcGVydHkoJ3Jvb20nKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnRWRnZSBDYXNlcycsICgpID0+IHtcclxuICAgIGl0KCdzaG91bGQgaGFuZGxlIHJvb20gd2l0aCBtaW5pbWFsIGluZm9ybWF0aW9uJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBtb2NrUm9vbUluZm8gPSB7XHJcbiAgICAgICAgcm9vbUlkOiAncm9vbS1taW5pbWFsJyxcclxuICAgICAgICBuYW1lOiAnJyxcclxuICAgICAgICBob3N0SWQ6ICcnLFxyXG4gICAgICAgIHN0YXR1czogJ1VOS05PV04nLFxyXG4gICAgICAgIG1lbWJlckNvdW50OiAwLFxyXG4gICAgICAgIGlzUHJpdmF0ZTogZmFsc2UsXHJcbiAgICAgICAgY3JlYXRlZEF0OiAnJyxcclxuICAgICAgfTtcclxuXHJcbiAgICAgIG1vY2tWYWxpZGF0ZUludml0ZUNvZGUubW9ja1Jlc29sdmVkVmFsdWUobW9ja1Jvb21JbmZvKTtcclxuXHJcbiAgICAgIGNvbnN0IGV2ZW50ID0gY3JlYXRlTW9ja0V2ZW50KEpTT04uc3RyaW5naWZ5KHsgaW52aXRlQ29kZTogJ01JTjEyMycgfSkpO1xyXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBoYW5kbGVyKGV2ZW50KTtcclxuXHJcbiAgICAgIGV4cGVjdChyZXN1bHQuc3RhdHVzQ29kZSkudG9CZSgyMDApO1xyXG4gICAgICBjb25zdCBib2R5ID0gSlNPTi5wYXJzZShyZXN1bHQuYm9keSk7XHJcbiAgICAgIGV4cGVjdChib2R5LnZhbGlkKS50b0JlKHRydWUpO1xyXG4gICAgICBleHBlY3QoYm9keS5yb29tKS50b0VxdWFsKG1vY2tSb29tSW5mbyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2hvdWxkIGhhbmRsZSB2ZXJ5IGxvbmcgcm9vbSBuYW1lcycsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgbG9uZ05hbWUgPSAnQScucmVwZWF0KDEwMDApO1xyXG4gICAgICBjb25zdCBtb2NrUm9vbUluZm8gPSB7XHJcbiAgICAgICAgcm9vbUlkOiAncm9vbS1sb25nJyxcclxuICAgICAgICBuYW1lOiBsb25nTmFtZSxcclxuICAgICAgICBob3N0SWQ6ICd1c2VyLTEyMycsXHJcbiAgICAgICAgc3RhdHVzOiAnQUNUSVZFJyxcclxuICAgICAgICBtZW1iZXJDb3VudDogMSxcclxuICAgICAgICBpc1ByaXZhdGU6IGZhbHNlLFxyXG4gICAgICAgIGNyZWF0ZWRBdDogJzIwMjYtMDEtMTBUMTI6MDA6MDBaJyxcclxuICAgICAgfTtcclxuXHJcbiAgICAgIG1vY2tWYWxpZGF0ZUludml0ZUNvZGUubW9ja1Jlc29sdmVkVmFsdWUobW9ja1Jvb21JbmZvKTtcclxuXHJcbiAgICAgIGNvbnN0IGV2ZW50ID0gY3JlYXRlTW9ja0V2ZW50KEpTT04uc3RyaW5naWZ5KHsgaW52aXRlQ29kZTogJ0xPTkcxMicgfSkpO1xyXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBoYW5kbGVyKGV2ZW50KTtcclxuXHJcbiAgICAgIGV4cGVjdChyZXN1bHQuc3RhdHVzQ29kZSkudG9CZSgyMDApO1xyXG4gICAgICBjb25zdCBib2R5ID0gSlNPTi5wYXJzZShyZXN1bHQuYm9keSk7XHJcbiAgICAgIGV4cGVjdChib2R5LnZhbGlkKS50b0JlKHRydWUpO1xyXG4gICAgICBleHBlY3QoYm9keS5yb29tLm5hbWUpLnRvQmUobG9uZ05hbWUpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn0pOyJdfQ==